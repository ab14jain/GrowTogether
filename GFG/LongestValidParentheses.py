#https://www.geeksforgeeks.org/problems/longest-valid-parentheses5657/1
class Solution:
    def maxLength(self, s):
        # code here

        stack = [-1]
        max_count = 0
        count = 0
        for i in range(len(s)):
            # curr = ''
            # if stack:
            #     curr = stack[-1]
            # if c in ")":
            #     if curr == '(' and c == ')':
            #         stack.pop()
            #         count +=2                
            #     else:  
            #         count = 0
            #     max_count = max(max_count, count)               
            # else:
            #     stack.append(c) 

            if s[i] == '(':
                stack.append(i)
            else:               
                stack.pop()                
                if not stack:
                    stack.append(i)
                else:
                    max_count = max(max_count, i - stack[-1])

        
        return max_count
    

s=Solution()
print(s.maxLength("()()))())))))(())())))()))))()((()(((((((()(()()))()(()())))((()((((((()))))()(())(((((())((((((((()))((())()(()())()(()(()(()))))))))))))))()()((()((())))())()(())(()(()(()(()))))(()()((()(((()())))(()()())((())((((()()()()())()()()()))))(()()(()()((()(()))))))(())()(()))((())(()()()((())((((((()()))(()()()(()((())()()((((((())(((((())(((())))((((()()))()(())(())()))(()(())(((()(()())())(()())()((()()(()(()()()())((((()((()(()(((((())((()(((())(()()(())))))))))(()())((())()((()()()()()))))(((()))(()()())(()))()()))()))))()))))((())((())((()((())()))(()()))))(()))()))()()))))()(())()((())(()())()()()()()))()))()((((((()))))()())))))(()()(()())()((()(((()()))((()((()()(()()()()((())(())(()))())((()())))))())())()()(()())((())(((())(())(((()())()()(()(((())())()()(((()(()))())()()()((())((()()((((((((()()((()(((())()())))()()(()((()(())))))()((()))(()((()(())((()(())(((((("))
print(s.maxLength("((()"))
print(s.maxLength(")()())"))
print(s.maxLength(")(((()))"))
print(s.maxLength(")()())()()()()("))
print(s.maxLength("())()"))